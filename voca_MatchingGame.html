<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Nối Từ</title>
    <style>
        /* Giữ nguyên CSS cũ */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            transition: background-color 0.5s;
        }

        .container {
            max-width: 450px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2196F3;
        }

        .button-group {
            margin-bottom: 20px;
        }

        .btn {
            padding: 10px 20px;
            margin: 0 10px;
            font-size: 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .start {
            background-color: #4CAF50;
            color: white;
        }

        .start:hover {
            background-color: #45a049;
        }

        .data {
            background-color: #2196F3;
            color: white;
        }

        .data:hover {
            background-color: #1e87db;
        }

        .reset {
            background-color: #f44336;
            color: white;
        }

        .reset:hover {
            background-color: #da190b;
        }

        /* Thêm style cho dropdown */
        #lessonSelect {
            padding: 10px;
            font-size: 16px;
            margin: 10px 0;
            border: 2px solid #2196F3;
            border-radius: 5px;
            width: 200px;
        }

        /* Các style khác giữ nguyên */
        .question {
            margin: 20px 0;
        }

        #studentName {
            border: 2px solid #2196F3;
            border-radius: 30px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            padding: 10px;
            font-size: 24px;
            margin: 0 auto;
            width: 280px;
           display: none;
        }

        .word-pairs {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .column {
            width: 45%;
            display: flex;
            flex-direction: column;
        }

        .word {
            border: 2px solid #2196f3;
            padding: 10px;
            margin: 5px 0;
            cursor: pointer;
            background-color: #fff;
            border-radius: 10px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 40px;
            font-size: 22px;
        }

        .word.chinese {
            font-family: '楷体', sans-serif;
            font-size: 30px;
        }

        .word.meaning {
            font-family: Arial, sans-serif;
        }

        .word:hover {
            background-color: #f0f0f0;
        }

        .word.correct {
            background-color: #4CAF50;
            color: white;
        }

        .word.wrong {
            background-color: #f44336;
            color: white;
            animation: shake 0.5s;
        }

        .word.selected {
            background-color: #2196F3;
            color: white;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Trò chơi nối từ</h1>
        <div>
            <select id="lessonSelect">
                <option value="">Chọn bài học</option>
            </select>
        </div>
        <div>
            <label for="vocabCount">Số lượng từ vựng (tối đa 10):</label>
            <input type="number" id="vocabCount" value="5" min="1" max="10" />
        </div>
        <div class="button-group">
            <button id="startBtn" class="btn start">Bắt đầu</button>
            <button id="shuffleBtn" class="btn data" style="display: none;">Xáo trộn</button>
            <button id="resetBtn" class="btn reset" style="display: none;">Tiếp theo</button>
        </div>
        <div class="question">
            <div class="box" id="studentName">Chọn học sinh</div>
        </div>

        <div class="word-pairs">
            <div class="column" id="leftColumn"></div>
            <div class="column" id="rightColumn"></div>
        </div>

        <div id="result"></div>
    </div>

    <script>
        // Danh sách học sinh
        const originalStudents = [
            'Nguyễn Đức Thành', 
            'Nguyễn Khánh Phương', 
            'Nguyễn Phương Nhi', 
            'Nghiêm Diệu Linh', 
            'Nguyễn Minh Hằng', 
            'Nguyễn Đức Trung', 
            'Hoàng Minh Thái', 
            'Nguyễn Đức Bảo Phong', 
            'Tạ Thị Ngọc Anh', 
            'Vương Thanh Hà', 
            'Hoàng Tuấn Thành', 
            'Nguyễn Thị Trang', 
            'Hoàng Thế Anh Quân', 
            'Trịnh Công Minh', 
            'Trịnh Anh Kiệt'
        ];

        // Dữ liệu từ vựng theo bài học
        const lessonVocabulary = {
            'H1 Bài 1: 老师您好！Em chào thầy ạ!': [
    { vocab: "你", meaning: "bạn, cậu" },
    { vocab: "我", meaning: "tôi" },
    { vocab: "您", meaning: "ngài (lịch sự)" },
    { vocab: "老师", meaning: "thầy/cô giáo" },
    { vocab: "学生", meaning: "học sinh" },
    { vocab: "好", meaning: "tốt, khỏe" },
    { vocab: "很", meaning: "rất" },
    { vocab: "吗", meaning: "không(trợ từ nghi vấn)" },
    { vocab: "谢谢", meaning: "cảm ơn" },
    { vocab: "这", meaning: "này, đây" },
    { vocab: "那", meaning: "kia, đó" },
    { vocab: "是", meaning: "là" },
    { vocab: "不", meaning: "không (phủ định)" },
    { vocab: "本子", meaning: "vở" },
    { vocab: "书", meaning: "sách" },
    { vocab: "你好", meaning: "xin chào" },
    { vocab: "再见", meaning: "tạm biệt" },
    { vocab: "陈楠", meaning: "Trần Nam" },
    { vocab: "国安", meaning: "Quốc An" },
],
'H1 Bài 2: 谢谢你！Cảm ơn bạn!':[
    { vocab: "爷爷", meaning: "ông " },
    { vocab: "奶奶", meaning: "bà" },
    { vocab: "爸爸", meaning: "bố" },
    { vocab: "妈妈", meaning: "mẹ" },
    { vocab: "哥哥", meaning: "anh trai" },
    { vocab: "姐姐", meaning: "chị gái" },
    { vocab: "弟弟", meaning: "em trai" },
    { vocab: "妹妹", meaning: "em gái" },
    { vocab: "医生", meaning: "bác sĩ" },
    { vocab: "记者", meaning: "phóng viên" },
    { vocab: "公安", meaning: "công an" },
    { vocab: "警察", meaning: "cảnh sát" },
    { vocab: "律师", meaning: "luật sư" },
    { vocab: "厨师", meaning: "đầu bếp" },
    { vocab: "演员", meaning: "diễn viên" },
    { vocab: "司机", meaning: "tài xế" },
    { vocab: "护士", meaning: "y tá" },
    { vocab: "部队", meaning: "bộ đội" },
    { vocab: "消防员", meaning: "lính cứu hỏa" },
    { vocab: "工人", meaning: "công nhân" },
    { vocab: "农民", meaning: "nông dân" },
    { vocab: "公务员", meaning: "công chức" },
],
'H1 Bài 3: 你叫什么名字?Bạn tên là gì?':[
    { vocab: "叫", meaning: "gọi, tên là" },
    { vocab: "请", meaning: "Mời, xin" },
    { vocab: "问", meaning: "Hỏi" },
    { vocab: "吃", meaning: "Ăn" },
    { vocab: "喝", meaning: "Uống" },
    { vocab: "说", meaning: "Nói" },
    { vocab: "喜欢", meaning: "Thích" },
    { vocab: "什么", meaning: "Gì, cái gì" },
    { vocab: "名字", meaning: "Tên" },
    { vocab: "贵姓", meaning: "Quý tính" },
    { vocab: "姓", meaning: "Họ" },
    { vocab: "他", meaning: "Anh ấy" },
    { vocab: "她", meaning: "Cô ấy" },
    { vocab: "们", meaning: "Hậu tố số nhiều " },
    { vocab: "人", meaning: "Người" },
    { vocab: "也", meaning: "Cũng" },
    { vocab: "都", meaning: "Đều" },
    { vocab: "中国", meaning: "Trung Quốc" },
    { vocab: "美国", meaning: "Mỹ" },
    { vocab: "英国", meaning: "Anh" },
    { vocab: "韩国", meaning: "Hàn Quốc" },
    { vocab: "泰国", meaning: "Thái Lan" },
    { vocab: "德国", meaning: "Đức" },
    { vocab: "法国", meaning: "Pháp" },
    { vocab: "日本", meaning: "Nhật Bản" },
    { vocab: "越南", meaning: "Việt Nam" },
    { vocab: "汉语", meaning: "Tiếng Hán" },
    { vocab: "英语", meaning: "Tiếng Anh" },
],
         };

        let students = [...originalStudents];
        let vocabPairs = [];
        let selectedWord1 = null;
        let selectedWord2 = null;
        let correctPairs = {};
        let matchedPairs = 0;

        // Khởi tạo dropdown bài học
        function initializeLessonSelect() {
            const select = document.getElementById('lessonSelect');
            Object.keys(lessonVocabulary).forEach(lesson => {
                const option = document.createElement('option');
                option.value = lesson;
                option.textContent = lesson;
                select.appendChild(option);
            });
        }

        // Sự kiện khi chọn bài học
        document.getElementById('lessonSelect').addEventListener('change', function() {
            const selectedLesson = this.value;
            if (selectedLesson) {
                vocabPairs = [...lessonVocabulary[selectedLesson]];
                document.getElementById('startBtn').disabled = false;
            } else {
                document.getElementById('startBtn').disabled = true;
            }
        });

        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('resetBtn').addEventListener('click', resetGame);
        document.getElementById('shuffleBtn').addEventListener('click', shuffleMeanings);

        function startGame() {
            if (!document.getElementById('lessonSelect').value) {
                alert('Vui lòng chọn bài học trước khi bắt đầu!');
                return;
            }

            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'inline-block';
            document.getElementById('shuffleBtn').style.display = 'inline-block';

            let vocabCount = parseInt(document.getElementById('vocabCount').value);
            if (vocabCount < 1 || vocabCount > 10) {
                alert("Vui lòng nhập số lượng từ vựng từ 1 đến 10.");
                return;
            }

            selectRandomStudent();
            showVocabPairs(vocabCount);
        }

        function selectRandomStudent() {
            let studentNameBox = document.getElementById('studentName');
            let interval = setInterval(() => {
                studentNameBox.innerText = students[Math.floor(Math.random() * students.length)];
            }, 100);

            setTimeout(() => {
                clearInterval(interval);
                if (students.length === 0) {
                    students = [...originalStudents];
                }
                let randomIndex = Math.floor(Math.random() * students.length);
                let selectedStudent = students.splice(randomIndex, 1)[0];
                studentNameBox.innerText = selectedStudent;
            }, 2000);
        }

        function showVocabPairs(count) {
            let leftColumn = document.getElementById('leftColumn');
            let rightColumn = document.getElementById('rightColumn');
            leftColumn.innerHTML = '';
            rightColumn.innerHTML = '';
            correctPairs = {};
            selectedWord1 = null;
            selectedWord2 = null;
            matchedPairs = 0;

            let randomPairs = vocabPairs.sort(() => 0.5 - Math.random()).slice(0, count);
            let shuffledMeanings = randomPairs.map(pair => pair.meaning).sort(() => 0.5 - Math.random());

            randomPairs.forEach((pair, index) => {
                let leftWord = createWordElement(pair.vocab, 'left' + index, true);
                let rightWord = createWordElement(shuffledMeanings[index], 'right' + index, false);

                correctPairs[pair.vocab] = pair.meaning;

                leftColumn.appendChild(leftWord);
                rightColumn.appendChild(rightWord);
            });

            document.querySelector('.word-pairs').style.display = 'flex';
            document.getElementById('result').innerText = '';
        }

        function createWordElement(text, id, isLeft) {
            let wordElement = document.createElement('div');
            wordElement.classList.add('word');
            wordElement.id = id;
            wordElement.innerText = text;
            wordElement.addEventListener('click', selectWord);
            wordElement.setAttribute('aria-label', isLeft ? 'Từ vựng: ' + text : 'Nghĩa: ' + text);

            if (isLeft) {
                wordElement.classList.add('chinese');
            } else {
                wordElement.classList.add('meaning');
            }

            return wordElement;
        }

        function selectWord() {
            if (this.classList.contains('correct')) return;

            if (!selectedWord1) {
                selectedWord1 = this;
                this.classList.add('selected');
            } else if (!selectedWord2 && this !== selectedWord1) {
                selectedWord2 = this;
                this.classList.add('selected');

                checkMatch();
            }
        }

        function checkMatch() {
            if (correctPairs[selectedWord1.innerText] === selectedWord2.innerText ||
                correctPairs[selectedWord2.innerText] === selectedWord1.innerText) {
                
                selectedWord1.classList.add('correct');
                selectedWord2.classList.add('correct');
                matchedPairs++;

                selectedWord1.remove();
                selectedWord2.remove();

                updateWordColumns();

                if (matchedPairs === Object.keys(correctPairs).length) {
                    showResult("Chúc mừng! Bạn đã hoàn thành bài tập.");
                }
            } else {
                document.body.style.backgroundColor = "red";
                setTimeout(() => {
                    document.body.style.backgroundColor = "#f0f0f0";
                }, 300);

                selectedWord1.classList.add('wrong');
                selectedWord2.classList.add('wrong');

                setTimeout(() => {
                    selectedWord1.classList.remove('wrong', 'selected');
                    selectedWord2.classList.remove('wrong', 'selected');
                }, 500);
            }

            setTimeout(() => {
                selectedWord1.classList.remove('selected');
                selectedWord2.classList.remove('selected');
                selectedWord1 = null;
                selectedWord2 = null;
            }, 500);
        }

        function updateWordColumns() {
            const leftColumn = document.getElementById('leftColumn');
            const rightColumn = document.getElementById('rightColumn');

            Array.from(leftColumn.children).forEach(node => {
                if (node.nodeType === Node.ELEMENT_NODE) {
                    leftColumn.appendChild(node);
                }
            });

            Array.from(rightColumn.children).forEach(node => {
                if (node.nodeType === Node.ELEMENT_NODE) {
                    rightColumn.appendChild(node);
                }
            });
        }

        function shuffleMeanings() {
            let rightColumn = document.getElementById('rightColumn');
            let meanings = Array.from(rightColumn.children);
            rightColumn.innerHTML = '';

            meanings.sort(() => Math.random() - 0.5);

            meanings.forEach(meaning => {
                rightColumn.appendChild(meaning);
            });
        }

        function resetGame() {
            selectRandomStudent();
            showVocabPairs(parseInt(document.getElementById('vocabCount').value));
            document.getElementById('result').innerText = '';
        }

        function showResult(message) {
            document.getElementById('result').innerText = message;
        }

        // Khởi tạo khi tải trang
        window.onload = function() {
            initializeLessonSelect();
            document.getElementById('startBtn').disabled = true;
        };
    </script>
</body>
</html>
